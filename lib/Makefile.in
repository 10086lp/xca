#
#  @configure_input@
#
# $Id$

VERSION=@PACKAGE_VERSION@
TARGET=xca-$(VERSION)

GCC=@CXX@
CC=@CC@
MOC=@MOC@
AR=@AR@
RANLIB=@RANLIB@

CPPFLAGS=@CPPFLAGS@ @DEFS@
CFLAGS=-Wall @ac_DEBUG@

##############################################


PKIOBJS=pki_base.o pki_key.o pki_x509super.o pki_x509req.o pki_x509.o asn1time.o x509name.o
# pki_pkcs12.o pki_temp.o pki_crl.o pki_pkcs7.o
DBNAMES=db_key db_x509super db_x509req db_x509 db_temp db_crl
DBOBJS=db_base.o pass_info.o $(patsubst %,%.o,$(DBNAMES)) $(patsubst %,moc_%.o,$(DBNAMES))
DB_CPP=$(patsubst %,moc_%.cpp,$(DBNAMES))

all: libpki.a libxcadb.a

libpki.a: $(PKIOBJS)
	$(AR) rc $@ $(PKIOBJS)
	$(RANLIB) $@

libxcadb.a: $(DBOBJS)
	$(AR) rc $@ $(DBOBJS)
	$(RANLIB) $@
	
%.o: %.cpp 
	$(CC) $(CPPFLAGS) $(CFLAGS) -c $< -o $@
clean:
	rm -rf *~ *.o *.a $(DB_CPP)

distclean: clean
	rm -f Makefile base.h

moc_%.cpp: %.h %.cpp
	$(MOC) $< -o $@
  
.SECONDARY: $(DB_CPP)
